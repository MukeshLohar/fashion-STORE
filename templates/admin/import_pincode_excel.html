{% extends "admin/base_site.html" %}

{% block content %}
<h1>Import Pincode Zones from Excel</h1>

<div class="module" style="margin: 20px 0;">
    <h2>Instructions</h2>
    <p>Upload an Excel file (.xlsx or .xls) with pincode to zone mappings.</p>
    
    <h3>File Format:</h3>
    <table style="border-collapse: collapse; margin: 20px 0;">
        <thead style="background-color: #f0f0f0;">
            <tr>
                <th style="border: 1px solid #ddd; padding: 8px;">Column</th>
                <th style="border: 1px solid #ddd; padding: 8px;">Required</th>
                <th style="border: 1px solid #ddd; padding: 8px;">Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;"><strong>Pincode</strong></td>
                <td style="border: 1px solid #ddd; padding: 8px;">Yes</td>
                <td style="border: 1px solid #ddd; padding: 8px;">6-digit pincode</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;"><strong>Zone</strong></td>
                <td style="border: 1px solid #ddd; padding: 8px;">Yes</td>
                <td style="border: 1px solid #ddd; padding: 8px;">Valid values: north, south, east, west, central</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;"><strong>City</strong></td>
                <td style="border: 1px solid #ddd; padding: 8px;">No</td>
                <td style="border: 1px solid #ddd; padding: 8px;">City name</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;"><strong>State</strong></td>
                <td style="border: 1px solid #ddd; padding: 8px;">No</td>
                <td style="border: 1px solid #ddd; padding: 8px;">State name</td>
            </tr>
        </tbody>
    </table>
    
    <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; margin: 20px 0; border-radius: 4px;">
        <strong>Note:</strong>
        <ul>
            <li>Zone names must be lowercase (north, south, east, west, central)</li>
            <li>If a pincode already exists, it will be updated</li>
            <li>Make sure shipping zones are created before importing pincodes</li>
            <li>Download the sample template for the correct format</li>
        </ul>
    </div>
</div>

<form method="post" enctype="multipart/form-data" style="margin: 20px 0;">
    {% csrf_token %}
    
    <div class="form-row">
        <div>
            <label for="excel_file"><strong>Select Excel File:</strong></label>
            <br>
            <input type="file" name="excel_file" id="excel_file" accept=".xlsx,.xls" required style="margin: 10px 0;">
        </div>
    </div>
    
    <div class="submit-row" style="margin-top: 20px;">
        <input type="submit" value="Import Pincodes" class="default" style="background-color: #417690; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">
        <a href="{% url 'admin:shop_pincodezone_changelist' %}" class="button cancel-link" style="margin-left: 10px;">Cancel</a>
    </div>
</form>

<div style="margin-top: 30px;">
    <a href="{% url 'admin:export_pincode_sample' %}" class="button" style="background-color: #28a745; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">
        Download Sample Excel Template
    </a>
</div>

{% endblock %}
